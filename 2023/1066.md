---
title: ä¸€ä¸ªéšæœºç”Ÿæˆmipsæ±‡ç¼–æŒ‡ä»¤å’Œå…¶å¯¹åº”æœºå™¨ç çš„pythonç¨‹åº
mathjax: true
comments: false
---
<div class="post-info">
<span>alkaid</span>
|
<abbr title="2023-10-29T17:50:43.121025+08:00"><time datetime="2023-10-29T17:50:43.121025+08:00">2023-10-29 17:50:43</time></abbr>
|
<span>â­ï¸ 2</span>
|
<span>ğŸ’¬ï¸ 2</span>
<br>
<div></div>
</div>

<div id="reply-4092" class="reply reply-l0">
<div class="reply-header">
<span>alkaid</span>
</div>
<div class="reply-text">

# ä½¿ç”¨æŒ‡å—

æ”¯æŒç”Ÿæˆçš„æŒ‡ä»¤ä¸ºï¼š`add, sub, ori, lw, sw, beq, lui, nop`

æ‰€æœ‰æŒ‡ä»¤çš„æ¶‰åŠåˆ°çš„5ä½å¯„å­˜å™¨ç¼–å·ã€16ä½ç«‹å³æ•°å‡ä¸ºéšæœºç”Ÿæˆ

é™¤äº†ï¼š

`sw`å›ºå®šä¸º`sw offset($0)`ï¼Œ`offset`åªä¼šä»`0x00000000`å¼€å§‹**é¡ºåºç”Ÿæˆ**ï¼Œæ¯æ¬¡ **+4**

`lw`å›ºå®šä¸º`lw offset($0)`ï¼Œå¹¶ä¸”åªä¼šä»**å·²ç»å­˜å‚¨è¿‡æ•°æ®**çš„å†…å­˜ä¸­è¯»å–ï¼Œè‹¥æ²¡æœ‰å­˜å‚¨è¿‡ï¼Œä¼šç”Ÿæˆ`nop`

`beq`åªä¼šè·³è½¬åˆ°å½“å‰æŒ‡ä»¤åçš„**1-10**æ¡æŒ‡ä»¤ *ï¼ˆå› ä¸ºè·³åˆ°å‰é¢å¤§æ¦‚ç‡æ­»å¾ªç¯...ï¼‰*

**ç¨‹åºä¼šè‡ªåŠ¨åœ¨mipsæ±‡ç¼–æ–‡ä»¶æ¯ä¸€æ¡æŒ‡ä»¤å‰åŠ å…¥``lable<i>:``æ ‡è¯†ç¬¦**

ä¾‹å¦‚ï¼š

```
lable1:
nop
lable2:
add $1, $2, $3
```
ä¸‹è½½åœ°å€ï¼š

[æ–‡ä»¶åï¼šmips ans hexCode generator.py<br/>æœ‰æ•ˆæœŸé™ï¼š2023-11-28 17:46](https://bhpan.buaa.edu.cn/link/AA2D754D512F284FC4A349A0D4101EC880)<small>ï¼ˆæ— éœ€å­˜æ¡£ï¼‰</small>

æºä»£ç ï¼š
```python
# ä½¿ç”¨æ–¹æ³•ï¼šè¿è¡Œå®Œä¹‹åä¼šè‡ªåŠ¨åœ¨å½“å‰ç›®å½•ç”Ÿæˆtest.mipså’Œtest.txtæ–‡ä»¶ï¼Œå¯¹åº”mipsæ±‡ç¼–å’Œ16è¿›åˆ¶æœºå™¨ç ï¼Œå¯¼å…¥è¿è¡Œå³å¯
# ps. lwåªä¼šåœ¨å·²ç»å­˜å…¥è¿‡çš„å†…å­˜èŒƒå›´å†…è¯»å–ï¼Œswä¼šä»0å¼€å§‹æŒ‰é¡ºåºå­˜å…¥
# ppss. ä¸ºé˜²æ­¢æ­»å¾ªç¯æˆ–è€…è¿‡å¿«ç»“æŸï¼Œbeqåªä¼šåœ¨å½“å‰æŒ‡ä»¤çš„å10æ¡æŒ‡ä»¤ä¹‹é—´è·³è½¬
from random import randint
from random import choice
instruct_R = {
    "add": "100000",
    "sub": "100010"
}
R = ["add", "sub"]
instruct_I = {
    "ori": "001101",
    "lw": "100011",
    "sw": "101011",
    "beq": "000100",
    "lui": "001111"
}
I = ["ori", "lw", "sw", "beq", "lui"]
instructCounter = 0
memoryAddr = -1
instructNum = 300

def generate_R():
    op = "000000"
    rs = randint(0, 31)
    rt = randint(0, 31)
    rd = randint(0, 31)
    shamt = "00000"
    instruct = choice(R)
    func = instruct_R[instruct]
    mips = instruct + " $" + str(rd) + ", $" + str(rs) + ", $" + str(rt)
    binCode = '0b' + op + bin(rs)[2:6].zfill(5) + bin(rt)[2:6].zfill(5) + bin(rd)[2:6].zfill(5) + shamt + func
    hexCode = hex(int(binCode, 2))
    return mips, binCode, hexCode
def generate_I():
    global memoryAddr
    instruct = choice(I)
    op = instruct_I[instruct]
    rs = randint(0, 31)
    rt = randint(0, 31)
    imm = randint(0, 65535)
    # imm
    if(instruct == "lw"):
        if(memoryAddr == -1):
            return "nop", "0b00000000000000000000000000000000", "0x00000000"
        else:
            imm = randint(0, memoryAddr) * 4
    elif(instruct == "sw"):
        memoryAddr = memoryAddr + 1
        imm = memoryAddr * 4
    elif(instruct == "beq"):
        imm = randint(instructCounter + 1, min(instructCounter + 10, instructNum - 1))
    # mips
    if(instruct == "lui"):
        rs = 0
        mips = instruct + " $" + str(rt) + ", " + str(imm)
    elif(instruct == "sw" or instruct == "lw"):
        mips = instruct + " $" + str(rt) + ' ' + str(imm) + "($0)"
    elif(instruct == "beq"):
        mips = instruct + " $" + str(rt) + ", $" + str(rs) + ", " + "lable" + str(imm)
    else:
        mips = instruct + " $" + str(rt) + ", $" + str(rs) + ", " + str(imm)
    binCode = '0b' + op + bin(rs)[2:6].zfill(5) + bin(rt)[2:6].zfill(5) + bin(imm)[2:17].zfill(16)
    hexCode = hex(int(binCode, 2))
    return mips, binCode, hexCode

if __name__ == "__main__":
    mipsFile = open("test.mips", "w")
    hexFile = open("test.txt", "w")
    hexFile.write("v2.0 raw\n")
    for i in range(1, instructNum):
        code = "", "", ""
        instructCounter = instructCounter + 1
        if randint(0, 1) == 0:
            code = generate_I()
        else:
            code = generate_R()
        mipsFile.write("lable" + str(instructCounter) + ':\n')
        mipsFile.write(code[0])
        mipsFile.write("\n")
        hexFile.write(code[2])
        hexFile.write("\n")
        print("lable" + str(instructCounter) + ':')
        print(code)

```


</div>
<div class="reply-footer">
<abbr title="2023-10-29T17:50:43.128201+08:00"><time datetime="2023-10-29T17:50:43.128201+08:00">2023-10-29 17:50:43</time></abbr>
|
<span>ä¿ç•™æ‰€æœ‰æƒåˆ©ï¼ˆä»£ç  MITï¼‰</span>
<span class="reply-vote">â¤ï¸ 3</span>
</div>
</div>
<hr class="reply-separator">
<div id="reply-4097" class="reply reply-l1">
<div class="reply-header">
<span>ForeverYoloï¼ˆåŠ©æ•™ï¼‰ <a href="#reply-4092">å›å¤</a> alkaid</span>
<div class="reply-verified">åŠ©æ•™è®¤è¯</div>
</div>
<div class="reply-text">

åŒå­¦ä½ å¥½ï¼Œè®¾è®¡çš„éå¸¸å¥½ï¼Œä½†åœ¨è¿™é‡Œè¯´å‡ ç‚¹ï¼š

1.å¯ä»¥é€šè¿‡è®¾è®¡ä¸€äº›"å·§å¦™"çš„ç»“æ„è®©è·³è½¬å¾€å‰è·³è½¬ä¸ä¼šå‡ºé”™ï¼Œè¯¸å¦‚åœ¨æµ‹è¯•æ•°æ®å¼€å¤´è®¾ç½®å¤„ç†è·³è½¬åŒºï¼Œè®©å‘å‰çš„è·³è½¬éƒ½è·³è½¬åˆ°è¿™é‡Œæ¥ã€‚

2.åŒå­¦ä¼¼ä¹æ²¡æœ‰è€ƒè™‘åŸåœ°è·³çš„æƒ…å†µï¼Œè¿™åè€Œæ˜¯æœ€å®¹æ˜“å‡ºé”™çš„ç‚¹ã€‚

3.å¼ºåº¦éœ€è¦è¿›ä¸€æ­¥æå‡ï¼Œä»¥è®¡ç®—æŒ‡ä»¤ä¸ºä¾‹ï¼Œè®¡ç®—æŒ‡ä»¤çš„æ­£è´Ÿå€¼ï¼Œè¾¹ç•Œå€¼ï¼Œæº¢å‡ºå€¼å‡éœ€è¦æµ‹è¯•ã€‚

ç»§ç»­åŠ æ²¹ï¼

</div>
<div class="reply-footer">
<abbr title="2023-10-29T19:18:38.408734+08:00"><time datetime="2023-10-29T19:18:38.408734+08:00">2023-10-29 19:18:38</time></abbr>
|
<span>CC BY-NC-SA 4.0</span>
<span class="reply-vote">â¤ï¸ 1</span>
</div>
</div>